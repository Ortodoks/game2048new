<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîÑ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .container {
            max-width: 600px;
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
        }
        h1 {
            text-align: center;
            margin-bottom: 20px;
            font-size: 2rem;
        }
        .warning {
            background: rgba(255, 152, 0, 0.2);
            border: 2px solid #FF9800;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 20px;
        }
        .step {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
        }
        .step h2 {
            color: #FFD700;
            margin-bottom: 10px;
            font-size: 1.3rem;
        }
        button {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: transform 0.2s;
            margin: 10px 0;
        }
        button:hover {
            transform: translateY(-2px);
        }
        .btn-primary {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
        }
        .btn-danger {
            background: linear-gradient(135deg, #f44336, #d32f2f);
            color: white;
        }
        .btn-info {
            background: linear-gradient(135deg, #2196F3, #1976D2);
            color: white;
        }
        .status {
            padding: 15px;
            border-radius: 12px;
            margin-top: 15px;
            font-weight: 600;
            display: none;
        }
        .status.show {
            display: block;
        }
        .status.success {
            background: rgba(76, 175, 80, 0.3);
            border: 2px solid #4CAF50;
        }
        .status.error {
            background: rgba(244, 67, 54, 0.3);
            border: 2px solid #f44336;
        }
        code {
            background: rgba(0, 0, 0, 0.3);
            padding: 2px 8px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
        }
        .hotkey {
            display: inline-block;
            background: rgba(255, 255, 255, 0.2);
            padding: 4px 10px;
            border-radius: 6px;
            font-weight: 700;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîÑ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ</h1>
        
        <div class="warning">
            <strong>‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞:</strong> –ë—Ä–∞—É–∑–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é —Ñ–∞–π–ª–æ–≤ –∏–∑ –∫—ç—à–∞.
            –ù—É–∂–Ω–æ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã!
        </div>

        <!-- –®–∞–≥ 1 -->
        <div class="step">
            <h2>–®–∞–≥ 1: –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏</h2>
            <p>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏—é –∫–ª–∞–≤–∏—à –¥–ª—è –ø–æ–ª–Ω–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏:</p>
            <p style="margin-top: 10px;">
                <strong>Mac:</strong> <span class="hotkey">Cmd + Shift + R</span><br>
                <strong>Windows/Linux:</strong> <span class="hotkey">Ctrl + Shift + F5</span>
            </p>
            <button class="btn-info" onclick="showHotkeyInstructions()">üìñ –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è</button>
            <div id="hotkey-status" class="status"></div>
        </div>

        <!-- –®–∞–≥ 2 -->
        <div class="step">
            <h2>–®–∞–≥ 2: –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞</h2>
            <button class="btn-danger" onclick="clearAllCache()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤–µ—Å—å –∫—ç—à</button>
            <div id="cache-status" class="status"></div>
        </div>

        <!-- –®–∞–≥ 3 -->
        <div class="step">
            <h2>–®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π</h2>
            <button class="btn-info" onclick="checkUpdates()">üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏–∏ —Ñ–∞–π–ª–æ–≤</button>
            <div id="check-status" class="status"></div>
        </div>

        <!-- –®–∞–≥ 4 -->
        <div class="step">
            <h2>–®–∞–≥ 4: –û—Ç–∫—Ä—ã—Ç—å –∏–≥—Ä—É</h2>
            <button class="btn-primary" onclick="openGame()">üéÆ –û—Ç–∫—Ä—ã—Ç—å –∏–≥—Ä—É —Å —á–∏—Å—Ç—ã–º –∫—ç—à–µ–º</button>
            <p style="margin-top: 10px; font-size: 0.9rem; opacity: 0.8;">
                –ò–≥—Ä–∞ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º –æ–±—Ö–æ–¥–∞ –∫—ç—à–∞
            </p>
        </div>

        <!-- –®–∞–≥ 5 -->
        <div class="step">
            <h2>–®–∞–≥ 5: –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞</h2>
            <p><strong>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤ –º–∞–≥–∞–∑–∏–Ω–µ:</strong></p>
            <ul style="margin: 10px 0; line-height: 1.8;">
                <li>‚úÖ –£ –±—É—Å—Ç–µ—Ä–æ–≤ –µ—Å—Ç—å –î–í–ï –∫–Ω–æ–ø–∫–∏ (üí∞ –∏ ‚≠ê)</li>
                <li>‚úÖ –£ —Å–∫–∏–Ω–æ–≤ –µ—Å—Ç—å –î–í–ï –∫–Ω–æ–ø–∫–∏ (üí∞ –∏ ‚≠ê)</li>
                <li>‚úÖ –ë—É—Å—Ç–µ—Ä ‚ù§Ô∏è –ñ–∏–∑–Ω–∏ —Å –±–µ–π–¥–∂–µ–º "–°–∫–æ—Ä–æ"</li>
                <li>‚úÖ –í—ã–∫–ª—é—á–µ–Ω–Ω—ã–µ —Å–∫–∏–Ω—ã –ù–ï –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è</li>
            </ul>
        </div>
    </div>

    <script>
        function showHotkeyInstructions() {
            const status = document.getElementById('hotkey-status');
            status.innerHTML = `
                <strong>–ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:</strong><br><br>
                1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É —Å –∏–≥—Ä–æ–π (index.html)<br>
                2. –ù–∞–∂–º–∏—Ç–µ –∏ —É–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ –Ω—É–∂–Ω—ã–µ –∫–ª–∞–≤–∏—à–∏:<br>
                   ‚Ä¢ Mac: Cmd + Shift + R<br>
                   ‚Ä¢ Windows/Linux: Ctrl + Shift + F5<br>
                3. –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –∏–∑ —Å–µ—Ä–≤–µ—Ä–∞<br>
                4. –í—Å–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –æ–±–Ω–æ–≤—è—Ç—Å—è<br><br>
                <strong>‚úÖ –≠—Ç–æ –°–ê–ú–´–ô –Ω–∞–¥–µ–∂–Ω—ã–π —Å–ø–æ—Å–æ–±!</strong>
            `;
            status.className = 'status show success';
        }

        async function clearAllCache() {
            const status = document.getElementById('cache-status');
            
            try {
                // –û—á–∏—Å—Ç–∫–∞ Service Worker
                if ('serviceWorker' in navigator) {
                    const registrations = await navigator.serviceWorker.getRegistrations();
                    for (let registration of registrations) {
                        await registration.unregister();
                    }
                }

                // –û—á–∏—Å—Ç–∫–∞ Cache API
                if ('caches' in window) {
                    const cacheNames = await caches.keys();
                    await Promise.all(
                        cacheNames.map(name => caches.delete(name))
                    );
                }

                // –û—á–∏—Å—Ç–∫–∞ localStorage —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∏–≥—Ä–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
                const gameData = {
                    gameState: localStorage.getItem('gameState'),
                    bestScore: localStorage.getItem('bestScore'),
                    userCoins: localStorage.getItem('userCoins'),
                    skinSettings: localStorage.getItem('skinSettings'),
                    skinPrices: localStorage.getItem('skinPrices'),
                    boosterPrices: localStorage.getItem('boosterPrices')
                };

                // –û—á–∏—â–∞–µ–º –≤—Å–µ
                localStorage.clear();

                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–≥—Ä–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
                Object.entries(gameData).forEach(([key, value]) => {
                    if (value) localStorage.setItem(key, value);
                });

                status.innerHTML = `
                    ‚úÖ –ö—ç—à —É—Å–ø–µ—à–Ω–æ –æ—á–∏—â–µ–Ω!<br><br>
                    –û—á–∏—â–µ–Ω–æ:<br>
                    ‚Ä¢ Service Workers: ${(await navigator.serviceWorker.getRegistrations()).length === 0 ? '‚úì' : '‚úó'}<br>
                    ‚Ä¢ Cache API: ‚úì<br>
                    ‚Ä¢ localStorage: ‚úì (–∏–≥—Ä–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã)<br><br>
                    <strong>–¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Cmd+Shift+R (–∏–ª–∏ Ctrl+Shift+F5)</strong>
                `;
                status.className = 'status show success';
            } catch (error) {
                status.innerHTML = `‚ùå –û—à–∏–±–∫–∞: ${error.message}`;
                status.className = 'status show error';
            }
        }

        async function checkUpdates() {
            const status = document.getElementById('check-status');
            status.innerHTML = 'üîÑ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤...';
            status.className = 'status show';

            try {
                const timestamp = Date.now();
                const files = [
                    'js/shop.js',
                    'styles.css',
                    'index.html'
                ];

                const results = [];
                for (const file of files) {
                    const response = await fetch(`${file}?v=${timestamp}`, { 
                        method: 'HEAD',
                        cache: 'no-cache'
                    });
                    results.push({
                        file,
                        ok: response.ok,
                        modified: response.headers.get('last-modified')
                    });
                }

                const html = results.map(r => 
                    `${r.ok ? '‚úÖ' : '‚ùå'} ${r.file}<br>` +
                    `<small style="opacity:0.7">–û–±–Ω–æ–≤–ª–µ–Ω: ${r.modified || '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</small>`
                ).join('<br>');

                status.innerHTML = `<strong>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏:</strong><br><br>${html}`;
                status.className = 'status show success';
            } catch (error) {
                status.innerHTML = `‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏: ${error.message}`;
                status.className = 'status show error';
            }
        }

        function openGame() {
            const timestamp = Date.now();
            const url = `index.html?nocache=${timestamp}`;
            window.open(url, '_blank');
            
            const status = document.createElement('div');
            status.className = 'status show success';
            status.innerHTML = `
                ‚úÖ –ò–≥—Ä–∞ –æ—Ç–∫—Ä—ã—Ç–∞ –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ!<br><br>
                –ü–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è –Ω–∞–∂–º–∏—Ç–µ <span class="hotkey">Cmd+Shift+R</span><br>
                —á—Ç–æ–±—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ —Ñ–∞–π–ª—ã
            `;
            document.querySelector('.step:last-child').appendChild(status);
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                alert('‚ö†Ô∏è –í–ê–ñ–ù–û!\n\n1. –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à –∫–Ω–æ–ø–∫–æ–π –Ω–∏–∂–µ\n2. –û—Ç–∫—Ä–æ–π—Ç–µ –∏–≥—Ä—É\n3. –ù–∞–∂–º–∏—Ç–µ Cmd+Shift+R (Mac) –∏–ª–∏ Ctrl+Shift+F5 (Windows)\n\n–¢–æ–ª—å–∫–æ —Ç–∞–∫ –≤—ã —É–≤–∏–¥–∏—Ç–µ –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è!');
            }, 500);
        });
    </script>
</body>
</html>
